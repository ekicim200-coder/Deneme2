<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Miner - Master Fix</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <style>
        :root { --neon-cyan: #00f3ff; --neon-gold: #ffd700; --neon-red: #ff3131; --bg-deep: #050508; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Segoe UI', monospace; color: white; }

        /* YÃœKLEME EKRANI */
        #loadingScreen { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: #050508; z-index: 99999; 
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
        }
        .loader {
            width: 50px; height: 50px; border: 5px solid #333; 
            border-top: 5px solid var(--neon-cyan); border-radius: 50%; 
            animation: spin 1s linear infinite; margin-bottom: 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* OYUN ALANI */
        #gameCanvas { display: block; width: 100%; height: 100%; }
        .view-section { display: none; width: 100%; height: 100vh; position: absolute; top: 0; left: 0; overflow-y: auto; padding-bottom: 100px; z-index: 10; }
        .view-section.active { display: block; animation: fadeIn 0.4s ease; }
        
        /* KARTLAR */
        .neon-card { background: rgba(15, 15, 25, 0.95); border: 1px solid rgba(0, 243, 255, 0.3); border-radius: 16px; padding: 20px; margin: 15px; box-shadow: 0 0 20px rgba(0, 243, 255, 0.05); }
        
        /* INPUT & BUTON */
        .neon-input { width: 100%; padding: 12px; margin: 10px 0; background: rgba(255,255,255,0.05); border: 1px solid #444; color: #fff; border-radius: 8px; text-align: center; font-size: 14px; outline: none; font-family: monospace; color: var(--neon-gold); }
        .neon-btn { background: rgba(0, 243, 255, 0.15); border: 1px solid var(--neon-cyan); color: var(--neon-cyan); padding: 12px; border-radius: 8px; font-weight: bold; width: 100%; cursor: pointer; margin-bottom: 10px; font-size: 14px; transition:0.2s; }
        .neon-btn:active { transform: scale(0.98); background: var(--neon-cyan); color: #000; }
        .neon-btn.gold { border-color: var(--neon-gold); color: var(--neon-gold); }
        .neon-btn.red { border-color: var(--neon-red); color: var(--neon-red); }
        
        /* ALT MENÃœ */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; height: 70px; background: rgba(0,0,0,0.95); border-top: 1px solid #333; display: flex; justify-content: space-around; align-items: center; z-index: 1000; }
        .nav-item { color: #666; font-size: 10px; font-weight: bold; display: flex; flex-direction: column; align-items: center; width: 20%; transition:0.3s; }
        .nav-item.active { color: var(--neon-cyan); text-shadow: 0 0 10px var(--neon-cyan); transform: translateY(-3px); }
        .nav-item i { font-size: 20px; margin-bottom: 5px; }
        
        /* HUD & LÄ°DERLÄ°K */
        #hud-top { position: absolute; top: 20px; left: 20px; z-index: 20; }
        .hud-pill { background: rgba(0,0,0,0.7); border-left: 3px solid var(--neon-cyan); padding: 6px 12px; border-radius: 4px; color: #fff; margin-bottom: 5px; display:flex; align-items:center; gap:8px; font-size:12px; }
        .rank-item { display: flex; align-items: center; padding: 12px; margin-bottom: 8px; border-radius: 8px; border-bottom: 1px solid #333; background: rgba(255,255,255,0.05); font-size: 13px; }
        
        /* REHBER (AKORDEON) */
        .guide-container { border: 1px solid #333; border-radius: 10px; overflow: hidden; margin-top: 10px; }
        .guide-item { border-bottom: 1px solid #333; background: rgba(255,255,255,0.02); }
        .guide-header { padding: 15px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; font-size: 14px; font-weight: bold; color: #eee; }
        .guide-content { display: none; padding: 15px; background: rgba(0,0,0,0.6); color: #bbb; font-size: 13px; line-height: 1.6; }
        .guide-item.active .guide-content { display: block; }

        /* MODAL */
        #modalOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 5000; display: none; align-items: center; justify-content: center; }
        .lang-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 15px; }
        .lang-item { border: 1px solid #333; padding: 15px; border-radius: 10px; text-align: center; cursor: pointer; color: white; background: rgba(255,255,255,0.05); }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 243, 255, 0.7); } 70% { transform: scale(1.05); box-shadow: 0 0 0 20px rgba(0, 243, 255, 0); } 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 243, 255, 0); } }
    </style>
</head>
<body>

    <div id="loadingScreen">
        <div class="loader"></div>
        <h2 style="color:var(--neon-cyan); letter-spacing:3px;">NEON MINER</h2>
        <p id="statusText" style="color:#888; font-size:12px; margin-top:10px;">Sunucuya BaÄŸlanÄ±yor...</p>
        <div id="errorLog" style="color:red; font-size:11px; margin-top:20px; max-width:80%; text-align:center; display:none; background:rgba(255,0,0,0.1); padding:10px; border-radius:5px;"></div>
    </div>

    <div id="gameView" class="view-section active">
        <canvas id="gameCanvas"></canvas>
        <div id="hud-top"></div>
        <div id="startContainer" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center; z-index:50;">
            <div style="width:160px; height:160px; border:2px solid var(--neon-cyan); border-radius:50%; display:flex; justify-content:center; align-items:center; cursor:pointer; box-shadow:0 0 40px var(--neon-cyan); animation: pulse 2s infinite;" onclick="startGame()">
                <h2 style="color:white; margin:0;" data-lang="start">BAÅžLAT</h2>
            </div>
            <p style="color:#aaa; margin-top:20px; font-size:12px;" data-lang="moveDesc">DOKUN VE BAÅžLA</p>
        </div>
        <div id="gameOverUI" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 85%; display: none; z-index: 60; text-align: center;">
            <div class="neon-card" style="border-color: var(--neon-red); box-shadow: 0 0 50px rgba(255, 49, 49, 0.3);">
                <h2 style="color: var(--neon-red); margin:0;" data-lang="gameOver">SÄ°STEM Ã‡Ã–KTÃœ</h2>
                <div id="sessionStats" style="margin: 20px 0; color: #fff; text-align: left;"></div>
                <button class="neon-btn gold" onclick="watchAd()" data-lang="recover">KURTAR (2X)</button>
                <button class="neon-btn" onclick="goToWalletFromGame()" data-lang="goToWallet">CÃœZDANA GÄ°T</button>
            </div>
        </div>
    </div>

    <div id="walletView" class="view-section">
        <h2 style="text-align:center; color:var(--neon-cyan); margin-top:30px;" data-lang="navWallet">CÃœZDAN</h2>
        <div id="walletList"></div>
    </div>

    <div id="newsView" class="view-section">
        <h2 style="text-align:center; color:var(--neon-cyan); margin-top:30px;" data-lang="navNews">HABERLER</h2>
        <div class="neon-card" style="border-color:#0088cc;">
            <h3 style="color:#0088cc; margin:0;" data-lang="tgTitle">TOPLULUK</h3>
            <p style="font-size:12px; color:#aaa; margin-bottom:10px;">GeliÅŸmeler iÃ§in kanala katÄ±l.</p>
            <button class="neon-btn" style="border-color:#0088cc; color:#0088cc;" onclick="window.open('https://telegram.org')" data-lang="tgJoin">KATIL</button>
        </div>
        <div class="neon-card" style="border-color:var(--neon-gold);">
            <h3 style="color:var(--neon-gold); margin:0;" data-lang="guideTitle">KILAVUZ</h3>
            <div class="guide-container">
                <div class="guide-item" onclick="this.classList.toggle('active')"><div class="guide-header"><span data-lang="g1t">Oyun</span> <i class="fas fa-chevron-down"></i></div><div class="guide-content" data-lang="g1d">ParmaÄŸÄ±nÄ± sÃ¼rÃ¼kle, coin topla.</div></div>
                <div class="guide-item" onclick="this.classList.toggle('active')"><div class="guide-header"><span data-lang="g2t">AyÄ±lar</span> <i class="fas fa-chevron-down"></i></div><div class="guide-content" data-lang="g2d">KÄ±rmÄ±zÄ± ayÄ±lardan kaÃ§!</div></div>
                <div class="guide-item" onclick="this.classList.toggle('active')"><div class="guide-header"><span data-lang="g3t">Ã‡ekim</span> <i class="fas fa-chevron-down"></i></div><div class="guide-content" data-lang="g3d">Limit 1.0M olunca Ã§ek.</div></div>
                <div class="guide-item" onclick="this.classList.toggle('active')"><div class="guide-header"><span data-lang="g4t">Referans</span> <i class="fas fa-chevron-down"></i></div><div class="guide-content" data-lang="g4d">%30 Komisyon kazan.</div></div>
            </div>
        </div>
    </div>

    <div id="champView" class="view-section">
        <div style="text-align:center; padding: 20px;">
            <h2 style="color: var(--neon-gold); margin:0;" data-lang="navChamp">LÄ°G</h2>
            <div style="display:flex; background:rgba(255,255,255,0.1); border-radius:8px; margin-top:15px; padding:4px;">
                <button id="tabDaily" class="neon-btn active" style="margin:0; border:none; background:var(--neon-cyan); color:#000;" onclick="switchLbTab('daily')" data-lang="lbDaily">GÃœNLÃœK</button>
                <button id="tabRef" class="neon-btn" style="margin:0; border:none; background:transparent; color:#888;" onclick="switchLbTab('ref')" data-lang="lbRef">AYLIK</button>
            </div>
        </div>
        <div id="rankContainer" style="padding: 0 15px;"></div>
    </div>

    <div id="settingsView" class="view-section">
        <h2 style="text-align:center; color:var(--neon-cyan); margin-top:30px;" data-lang="navSettings">AYARLAR</h2>
        <div class="neon-card">
            <p style="color:#888; font-size:12px;" data-lang="langTitle">DÄ°L</p>
            <button class="neon-btn" onclick="openLangModal()"><span id="activeLangName">ðŸ‡¹ðŸ‡· TÃ¼rkÃ§e</span></button>
        </div>
        
        <div class="neon-card" style="border-color:var(--neon-gold);">
            <h3 style="color:var(--neon-gold); margin:0;" data-lang="refTitle">REFERANS</h3>
            <p style="font-size:12px; color:#aaa;" data-lang="refDesc">%30 Komisyon.</p>
            <div style="display:flex; gap:10px; margin:10px 0;">
                <div style="flex:1; background:rgba(0,0,0,0.5); padding:10px; text-align:center; border-radius:8px;"><div style="font-size:18px; color:var(--neon-gold);" id="totalRefs">0</div><div style="font-size:10px; color:#888;" data-lang="refMembers">ÃœYE</div></div>
                <div style="flex:1; background:rgba(0,0,0,0.5); padding:10px; text-align:center; border-radius:8px;"><div style="font-size:18px; color:var(--neon-gold);" id="totalComm">0</div><div style="font-size:10px; color:#888;" data-lang="refEarnings">KAZANÃ‡</div></div>
            </div>
            <p style="color:#888; font-size:10px; margin-bottom:5px;">DAVET LÄ°NKÄ°N:</p>
            <input type="text" id="myRefLink" class="neon-input" value="YÃ¼kleniyor..." readonly>
            <button class="neon-btn gold" onclick="copyRefLink()" id="copyBtn">LÄ°NKÄ° KOPYALA</button>
        </div>
        <div class="neon-card">
            <div style="text-align:center; color:#666; font-size:10px;">ID: <span id="userIdDisplay">---</span></div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('game')" id="nav-game"><i class="fas fa-gamepad"></i><span data-lang="navGame">OYUN</span></div>
        <div class="nav-item" onclick="switchTab('news')" id="nav-news"><i class="fas fa-newspaper"></i><span data-lang="navNews">HABER</span></div>
        <div class="nav-item" onclick="switchTab('champ')" id="nav-champ"><i class="fas fa-trophy"></i><span data-lang="navChamp">LÄ°G</span></div>
        <div class="nav-item" onclick="switchTab('wallet')" id="nav-wallet"><i class="fas fa-wallet"></i><span data-lang="navWallet">CÃœZDAN</span></div>
        <div class="nav-item" onclick="switchTab('settings')" id="nav-settings"><i class="fas fa-cog"></i><span data-lang="navSettings">AYAR</span></div>
    </div>

    <div id="modalOverlay" style="display:none;">
        <div style="background:#111; border:1px solid var(--neon-cyan); border-radius:20px; width:80%; max-height:80%; overflow-y:auto;">
            <div style="padding:20px; border-bottom:1px solid #333; display:flex; justify-content:space-between;">
                <h3 style="margin:0; color:var(--neon-cyan);" data-lang="langTitle">DÄ°L</h3>
                <i class="fas fa-times" onclick="document.getElementById('modalOverlay').style.display='none'" style="font-size:24px; cursor:pointer; color:white;"></i>
            </div>
            <div id="langList" class="lang-grid"></div>
        </div>
    </div>

<script>
    // --- BURAYA DÄ°KKAT: KENDÄ° AYARLARINI YAPIÅžTIR ---
    const firebaseConfig = {
      apiKey: "AIzaSyBqsuakQQOdm1NcWLjYyMTyiLpGmoBh7iA",
      authDomain: "faucet-game.firebaseapp.com",
      projectId: "faucet-game",
      storageBucket: "faucet-game.firebasestorage.app",
      messagingSenderId: "258577212321",
      appId: "1:258577212321:web:302ebdcc27568e9c9e21e0",
      measurementId: "G-DXE818SCVE"
    };

    // BOT ADINI YAZ (Ã–nemli: Link oluÅŸturmak iÃ§in)
    const BOT_USERNAME = "faucetgamebot";
    const APP_NAME = "app"; // BotFather'da verdiÄŸin isim

    let db, auth;
    let user = { 
        balances:{BTC:0,ETH:0,USDT:0,TRX:0}, 
        addresses:{BTC:'',ETH:'',USDT:'',TRX:''},
        lang:'tr', referrals:[], totalComm:0, 
        lbData: { daily: [], ref: [], lastUpdate: 0 }
    };
    let telegramID = "demo_" + Math.floor(Math.random()*9999);

    // --- SÄ°STEM BAÅžLATMA ---
    try {
        firebase.initializeApp(firebaseConfig);
        auth = firebase.auth();
        db = firebase.firestore();
        
        const tg = window.Telegram.WebApp;
        tg.expand();
        
        if(tg.initDataUnsafe && tg.initDataUnsafe.user) {
            telegramID = tg.initDataUnsafe.user.id.toString();
            document.getElementById('userIdDisplay').innerText = telegramID;
            
            // Referans Yakalama
            const startParam = tg.initDataUnsafe.start_param;
            if(startParam && startParam !== telegramID) {
                console.log("Ref:", startParam);
            }
        }

        auth.signInAnonymously().then(() => {
            loadUserData();
        }).catch(e => {
            const errDiv = document.getElementById('errorLog');
            errDiv.style.display = 'block';
            errDiv.innerHTML = "HATA: Firebase Anonim GiriÅŸ KapalÄ±!<br>LÃ¼tfen konsoldan Authentication > Sign-in method > Anonymous'u aÃ§Ä±n.<br><br>" + e.message;
            document.getElementById('statusText').innerText = "BaÄŸlantÄ± HatasÄ±";
        });

    } catch(e) { alert("Config HatasÄ±: " + e.message); }

    // --- VERÄ° YÃ–NETÄ°MÄ° ---
    function loadUserData() {
        db.collection('users').doc(telegramID).get().then(doc => {
            if(doc.exists) { user = { ...user, ...doc.data() }; } 
            else { saveData(); }
            document.getElementById('loadingScreen').style.display = 'none';
            generateRefLink();
            updateAllUI();
        }).catch(e => {
            // Hata olursa offline devam etme, uyarÄ± ver
            document.getElementById('errorLog').style.display='block';
            document.getElementById('errorLog').innerText = "Veri Ã§ekilemedi: " + e.message;
        });
    }
    function saveData() { db.collection('users').doc(telegramID).set(user); }

    // --- REFERANS ---
    function generateRefLink() {
        const link = `https://t.me/${BOT_USERNAME}/${APP_NAME}?startapp=${telegramID}`;
        document.getElementById('myRefLink').value = link;
    }
    function copyRefLink() {
        const copyText = document.getElementById("myRefLink");
        copyText.select(); copyText.setSelectionRange(0, 99999); 
        navigator.clipboard.writeText(copyText.value).then(() => {
            const btn = document.getElementById('copyBtn');
            btn.innerText = "KOPYALANDI!";
            setTimeout(() => btn.innerText = "LÄ°NKÄ° KOPYALA", 2000);
        });
    }

    // --- LOGO & OYUN MOTORU ---
    const IMG_SRCS = {
        BTC: 'https://upload.wikimedia.org/wikipedia/commons/4/46/Bitcoin.svg',
        ETH: 'https://upload.wikimedia.org/wikipedia/commons/0/05/Ethereum_logo_2014.svg',
        USDT: 'https://cryptologos.cc/logos/tether-usdt-logo.png?v=025',
        TRX: 'https://cryptologos.cc/logos/tron-trx-logo.png?v=025'
    };
    const COIN_IMGS = {};
    for(let k in IMG_SRCS) { let i = new Image(); i.src = IMG_SRCS[k]; COIN_IMGS[k] = i; }

    const cvs = document.getElementById('gameCanvas');
    const cx = cvs.getContext('2d');
    let W, H, isPlaying=false, player={x:0, y:0, trail:[]}, entities=[], particles=[], bgStars=[], sessionEarn={BTC:0,ETH:0,USDT:0,TRX:0}, enemyInterval;
    const COINS=[{id:'BTC',color:'#f7931a'},{id:'ETH',color:'#627eea'},{id:'USDT',color:'#26a17b'},{id:'TRX',color:'#eb0029'}];

    function resize(){ W=window.innerWidth; H=window.innerHeight; cvs.width=W; cvs.height=H; bgStars=[]; for(let i=0;i<50;i++) bgStars.push({x:Math.random()*W,y:Math.random()*H,s:Math.random()*2,v:Math.random()*0.5}); }
    window.addEventListener('resize', resize); resize();

    function startGame() {
        document.getElementById('startContainer').style.display='none';
        isPlaying=true; player.x=W/2; player.y=H/2; player.trail=[]; entities=[]; sessionEarn={BTC:0,ETH:0,USDT:0,TRX:0};
        for(let i=0;i<6;i++) spawnEntity('coin');
        clearInterval(enemyInterval);
        enemyInterval = setInterval(() => { if(isPlaying) spawnEntity('enemy'); }, 1500); 
        loop();
    }

    function spawnEntity(type) {
        if(type==='coin') {
            const c = COINS[Math.floor(Math.random()*COINS.length)];
            entities.push({type:'coin', x:Math.random()*(W-20)+10, y:Math.random()*(H-20)+10, id:c.id, color:c.color, pulse:0});
        } else if(type==='enemy') {
            const side = Math.floor(Math.random()*4);
            let x,y,vx,vy; const speed=3;
            if(side===0){x=Math.random()*W;y=-50;vx=(Math.random()-0.5)*2;vy=speed;} else if(side===1){x=W+50;y=Math.random()*H;vx=-speed;vy=(Math.random()-0.5)*2;} else if(side===2){x=Math.random()*W;y=H+50;vx=(Math.random()-0.5)*2;vy=-speed;} else {x=-50;y=Math.random()*H;vx=speed;vy=(Math.random()-0.5)*2;}
            entities.push({type:'enemy', x,y,vx,vy, color:'#ff0044'});
        }
    }

    function loop() {
        if(!isPlaying) return;
        cx.fillStyle='rgba(5,5,8,0.4)'; cx.fillRect(0,0,W,H); 
        cx.fillStyle="white"; bgStars.forEach(s=>{ s.y+=s.v; if(s.y>H)s.y=0; cx.globalAlpha=0.3; cx.beginPath(); cx.arc(s.x,s.y,s.s,0,Math.PI*2); cx.fill(); }); cx.globalAlpha=1;

        player.trail.push({x:player.x, y:player.y}); if(player.trail.length>20) player.trail.shift();
        cx.beginPath(); cx.strokeStyle="rgba(0,243,255,0.5)"; cx.lineWidth=4; cx.lineCap="round";
        for(let i=0;i<player.trail.length-1;i++){ cx.moveTo(player.trail[i].x,player.trail[i].y); cx.lineTo(player.trail[i+1].x,player.trail[i+1].y); } cx.stroke();
        cx.shadowBlur=20; cx.shadowColor="#00f3ff"; cx.fillStyle='#fff'; cx.beginPath(); cx.arc(player.x,player.y,12,0,Math.PI*2); cx.fill(); cx.shadowBlur=0;

        for(let i=entities.length-1; i>=0; i--) {
            let e = entities[i];
            if(e.type==='coin') {
                e.pulse+=0.1; const r=16+Math.sin(e.pulse)*2;
                cx.shadowBlur=20; cx.shadowColor=e.color;
                let img = COIN_IMGS[e.id];
                if(img && img.complete && img.naturalHeight!==0) cx.drawImage(img, e.x-r, e.y-r, r*2, r*2);
                else { cx.fillStyle=e.color; cx.beginPath(); cx.arc(e.x,e.y,r,0,Math.PI*2); cx.fill(); }
                cx.shadowBlur=0;
                
                if(Math.hypot(player.x-e.x,player.y-e.y)<35) {
                    user.balances[e.id]+=1000; sessionEarn[e.id]+=1000; entities.splice(i,1); spawnEntity('coin'); updateHUD(true);
                    for(let k=0;k<8;k++) particles.push({x:e.x,y:e.y,vx:(Math.random()-0.5)*8,vy:(Math.random()-0.5)*8,life:1,color:e.color});
                    saveData();
                }
            } else if(e.type==='enemy') {
                e.x+=e.vx; e.y+=e.vy;
                cx.shadowBlur=20; cx.shadowColor='#ff0044'; cx.font="30px Arial"; cx.fillText("ðŸ»", e.x-15, e.y+10); cx.shadowBlur=0;
                if(Math.hypot(player.x-e.x,player.y-e.y)<30) { gameOver(); }
                if(e.x<-100 || e.x>W+100 || e.y<-100 || e.y>H+100) entities.splice(i,1);
            }
        }
        for(let i=particles.length-1;i>=0;i--){ let p=particles[i]; p.x+=p.vx; p.y+=p.vy; p.life-=0.05; if(p.life<=0) particles.splice(i,1); else { cx.globalAlpha=p.life; cx.fillStyle=p.color; cx.beginPath(); cx.arc(p.x,p.y,3,0,Math.PI*2); cx.fill(); } } cx.globalAlpha=1;
        requestAnimationFrame(loop);
    }
    cvs.addEventListener('touchmove',e=>{e.preventDefault(); player.x=e.touches[0].clientX; player.y=e.touches[0].clientY;},{passive:false});

    function gameOver() {
        isPlaying=false; clearInterval(enemyInterval); document.getElementById('gameOverUI').style.display='block'; saveData();
        let html=''; for(let k in sessionEarn) if(sessionEarn[k]>0) html+=`<div style="display:flex; justify-content:space-between; padding:5px; border-bottom:1px solid #333;"><span style="color:${COINS.find(x=>x.id==k).color}; font-weight:bold;">${k}</span><span>+${sessionEarn[k].toLocaleString()}</span></div>`;
        document.getElementById('sessionStats').innerHTML=html||"0";
    }

    // --- UI FONKSÄ°YONLARI ---
    window.goToWalletFromGame = function() { document.getElementById('gameOverUI').style.display = 'none'; document.getElementById('startContainer').style.display = 'block'; switchTab('wallet'); }
    window.watchAd = function() { alert("2X KAZANÃ‡!"); const mult = 2; for(let k in sessionEarn) user.balances[k] += sessionEarn[k]*mult; saveData(); document.getElementById('gameOverUI').style.display = 'none'; document.getElementById('startContainer').style.display = 'block'; switchTab('wallet'); }

    // --- 11 DÄ°L ---
    const i18n = {
        tr: { start:"BAÅžLAT", moveDesc:"DOKUN VE KEÅžFET", navGame:"OYUN", navNews:"HABER", navChamp:"LÄ°G", navWallet:"CÃœZDAN", navSettings:"AYAR", refTitle:"REFERANS", refDesc:"%30 Komisyon.", tgTitle:"TOPLULUK", tgDesc:"Kanala katÄ±l.", tgJoin:"KATIL", guideTitle:"KILAVUZ", g1t:"Oyun", g1d:"ParmaÄŸÄ±nÄ± sÃ¼rÃ¼kle, topla.", g2t:"DÃ¼ÅŸman", g2d:"AyÄ±lardan kaÃ§!", g3t:"Ã‡ekim", g3d:"1.0M Limit.", g4t:"Referans", g4d:"%30 Kazan.", refMembers:"ÃœYE", refEarnings:"KAZANÃ‡", gameOver:"SÄ°STEM Ã‡Ã–KTÃœ", recover:"KURTAR (2X)", goToWallet:"CÃœZDANA GÄ°T", langTitle:"DÄ°L SEÃ‡Ä°MÄ°", lbDaily:"GÃœNLÃœK", lbRef:"AYLIK", you:"SEN", withdraw:"Ã‡EKÄ°M", limit:"1M GEREKLÄ°", addrPlace:"Adres Girin", sentMsg:"Talep AlÄ±ndÄ±!" },
        en: { start:"START", moveDesc:"TOUCH TO EXPLORE", navGame:"GAME", navNews:"NEWS", navChamp:"RANK", navWallet:"WALLET", navSettings:"SETTINGS", refTitle:"REFERRAL", refDesc:"30% Commission.", tgTitle:"COMMUNITY", tgDesc:"Join channel.", tgJoin:"JOIN", guideTitle:"GUIDE", g1t:"Game", g1d:"Drag finger, collect.", g2t:"Enemy", g2d:"Avoid bears!", g3t:"Withdraw", g3d:"1.0M Limit.", g4t:"Referral", g4d:"Earn 30%.", refMembers:"MEMBERS", refEarnings:"EARNINGS", gameOver:"SYSTEM CRASH", recover:"RECOVER (2X)", goToWallet:"WALLET", langTitle:"LANGUAGE", lbDaily:"DAILY", lbRef:"MONTHLY", you:"YOU", withdraw:"WITHDRAW", limit:"1M REQUIRED", addrPlace:"Enter Address", sentMsg:"Request Sent!" },
        de: { start:"STARTEN", moveDesc:"BERÃœHREN", navGame:"SPIEL", navNews:"NEWS", navChamp:"RANG", navWallet:"BÃ–RSE", navSettings:"EINSTELLUNG", refTitle:"REFERENZ", refDesc:"30% Provision.", tgTitle:"GEMEINSCHAFT", tgDesc:"Beitreten.", tgJoin:"BEITRETEN", guideTitle:"ANLEITUNG", g1t:"Spiel", g1d:"Sammeln.", g2t:"Feind", g2d:"Vermeiden!", g3t:"Abheben", g3d:"1.0M Limit.", g4t:"Referenz", g4d:"30% Verdienen.", refMembers:"MITGLIEDER", refEarnings:"GEWINN", gameOver:"ABSTURZ", recover:"RETTEN", goToWallet:"BÃ–RSE", langTitle:"SPRACHE", lbDaily:"TÃ„GLICH", lbRef:"MONATLICH", you:"DU", withdraw:"ABHEBEN", limit:"1M NÃ–TIG", addrPlace:"Adresse", sentMsg:"Gesendet!" },
        es: { start:"INICIAR", moveDesc:"MUEVE", navGame:"JUEGO", navNews:"NOTICIAS", navChamp:"RANGO", navWallet:"CARTERA", navSettings:"AJUSTE", refTitle:"REFERIDOS", refDesc:"30% ComisiÃ³n.", tgTitle:"COMUNIDAD", tgDesc:"Ãšnete.", tgJoin:"UNIRSE", guideTitle:"GUÃA", g1t:"Juego", g1d:"Recoge.", g2t:"Enemigo", g2d:"Â¡Evita osos!", g3t:"Retiro", g3d:"LÃ­mite 1.0M.", g4t:"Ref", g4d:"Gana 30%.", refMembers:"MIEMBROS", refEarnings:"GANANCIAS", gameOver:"FALLO", recover:"RECUPERAR", goToWallet:"CARTERA", langTitle:"IDIOMA", lbDaily:"DIARIO", lbRef:"MENSUAL", you:"TÃš", withdraw:"RETIRAR", limit:"1M REQUERIDO", addrPlace:"DirecciÃ³n", sentMsg:"Â¡Enviado!" },
        fr: { start:"DÃ‰MARRER", moveDesc:"BOUGEZ", navGame:"JEU", navNews:"ACTUS", navChamp:"RANG", navWallet:"WALLET", navSettings:"RÃ‰GLAGE", refTitle:"PARRAINAGE", refDesc:"30% Commission.", tgTitle:"COMMUNAUTÃ‰", tgDesc:"Rejoindre.", tgJoin:"REJOINDRE", guideTitle:"GUIDE", g1t:"Jeu", g1d:"Collectez.", g2t:"Ennemi", g2d:"Ã‰vitez les ours!", g3t:"Retrait", g3d:"Limite 1.0M.", g4t:"Ref", g4d:"Gagnez 30%.", refMembers:"MEMBRES", refEarnings:"GAINS", gameOver:"PANNE", recover:"RÃ‰CUPÃ‰RER", goToWallet:"WALLET", langTitle:"LANGUE", lbDaily:"JOUR", lbRef:"MOIS", you:"VOUS", withdraw:"RETIRER", limit:"1M REQUIS", addrPlace:"Adresse", sentMsg:"EnvoyÃ©!" },
        ru: { start:"Ð¡Ð¢ÐÐ Ð¢", moveDesc:"Ð”Ð’Ð˜Ð“ÐÐ™Ð¡Ð¯", navGame:"Ð˜Ð“Ð Ð", navNews:"ÐÐžÐ’ÐžÐ¡Ð¢Ð˜", navChamp:"Ð¢ÐžÐŸ", navWallet:"ÐšÐžÐ¨Ð•Ð›Ð•Ðš", navSettings:"ÐÐÐ¡Ð¢Ð ", refTitle:"Ð Ð•Ð¤Ð•Ð ÐÐ›", refDesc:"30% ÐºÐ¾Ð¼Ð¸ÑÑÐ¸Ð¸.", tgTitle:"Ð¡ÐžÐžÐ‘Ð©Ð•Ð¡Ð¢Ð’Ðž", tgDesc:"Ð’ÑÑ‚ÑƒÐ¿Ð¸Ñ‚ÑŒ.", tgJoin:"Ð’Ð¡Ð¢Ð£ÐŸÐ˜Ð¢Ð¬", guideTitle:"Ð“ÐÐ™Ð”", g1t:"Ð˜Ð³Ñ€Ð°", g1d:"Ð¡Ð¾Ð±Ð¸Ñ€Ð°Ð¹.", g2t:"Ð’Ñ€Ð°Ð³", g2d:"Ð˜Ð·Ð±ÐµÐ³Ð°Ð¹ Ð¼ÐµÐ´Ð²ÐµÐ´ÐµÐ¹!", g3t:"Ð’Ñ‹Ð²Ð¾Ð´", g3d:"Ð›Ð¸Ð¼Ð¸Ñ‚ 1.0M.", g4t:"Ð ÐµÑ„", g4d:"30% Ð´Ð¾Ñ…Ð¾Ð´.", refMembers:"Ð£Ð§ÐÐ¡Ð¢ÐÐ˜ÐšÐ˜", refEarnings:"Ð”ÐžÐ¥ÐžÐ”", gameOver:"Ð¡Ð‘ÐžÐ™", recover:"Ð’ÐžÐ¡Ð¡Ð¢", goToWallet:"ÐšÐžÐ¨Ð•Ð›Ð•Ðš", langTitle:"Ð¯Ð—Ð«Ðš", lbDaily:"Ð”Ð•ÐÐ¬", lbRef:"ÐœÐ•Ð¡Ð¯Ð¦", you:"Ð’Ð«", withdraw:"Ð’Ð«Ð’ÐžÐ”", limit:"ÐÐ£Ð–ÐÐž 1Ðœ", addrPlace:"ÐÐ´Ñ€ÐµÑ", sentMsg:"ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾!" },
        pt: { start:"INICIAR", moveDesc:"MOVA", navGame:"JOGO", navNews:"NOTÃCIAS", navChamp:"RANK", navWallet:"CARTEIRA", navSettings:"AJUSTE", refTitle:"REFERÃŠNCIA", refDesc:"30% ComissÃ£o.", tgTitle:"COMUNIDADE", tgDesc:"Entrar.", tgJoin:"ENTRAR", guideTitle:"GUIA", g1t:"Jogo", g1d:"Colete.", g2t:"Inimigo", g2d:"Evite ursos!", g3t:"Saque", g3d:"Limite 1.0M.", g4t:"Ref", g4d:"Ganhe 30%.", refMembers:"MEMBROS", refEarnings:"GANHOS", gameOver:"ERRO", recover:"RECUPERAR", goToWallet:"CARTEIRA", langTitle:"IDIOMA", lbDaily:"DIÃRIO", lbRef:"MENSAL", you:"VOCÃŠ", withdraw:"SACAR", limit:"1M NECESSÃRIO", addrPlace:"EndereÃ§o", sentMsg:"Enviado!" },
        id: { start:"MULAI", moveDesc:"GERAK", navGame:"MAIN", navNews:"BERITA", navChamp:"RANK", navWallet:"DOMPET", navSettings:"PENGATURAN", refTitle:"REFERRAL", refDesc:"Komisi 30%.", tgTitle:"KOMUNITAS", tgDesc:"Gabung.", tgJoin:"GABUNG", guideTitle:"PANDUAN", g1t:"Main", g1d:"Kumpulkan.", g2t:"Musuh", g2d:"Hindari beruang!", g3t:"Tarik", g3d:"Limit 1.0M.", g4t:"Ref", g4d:"Dapat 30%.", refMembers:"ANGGOTA", refEarnings:"PENDAPATAN", gameOver:"ERROR", recover:"PULIHKAN", goToWallet:"DOMPET", langTitle:"BAHASA", lbDaily:"HARIAN", lbRef:"BULANAN", you:"ANDA", withdraw:"TARIK", limit:"BUTUH 1M", addrPlace:"Alamat", sentMsg:"Terkirim!" },
        ja: { start:"ã‚¹ã‚¿ãƒ¼ãƒˆ", moveDesc:"å‹•ã", navGame:"ã‚²ãƒ¼ãƒ ", navNews:"ãƒ‹ãƒ¥ãƒ¼ã‚¹", navChamp:"ãƒ©ãƒ³ã‚¯", navWallet:"è²¡å¸ƒ", navSettings:"è¨­å®š", refTitle:"ç´¹ä»‹", refDesc:"30%ç²å¾—ã€‚", tgTitle:"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£", tgDesc:"å‚åŠ ã€‚", tgJoin:"å‚åŠ ", guideTitle:"ã‚¬ã‚¤ãƒ‰", g1t:"ã‚²ãƒ¼ãƒ ", g1d:"é›†ã‚ã‚‹ã€‚", g2t:"æ•µ", g2d:"ç†Šã‚’é¿ã‘ã‚!", g3t:"å‡ºé‡‘", g3d:"åˆ¶é™ 1.0Mã€‚", g4t:"ç´¹ä»‹", g4d:"30%ç¨¼ãã€‚", refMembers:"ãƒ¡ãƒ³ãƒãƒ¼", refEarnings:"åŽç›Š", gameOver:"ã‚¨ãƒ©ãƒ¼", recover:"å›žå¾©", goToWallet:"è²¡å¸ƒ", langTitle:"è¨€èªž", lbDaily:"æ¯Žæ—¥", lbRef:"æ¯Žæœˆ", you:"ã‚ãªãŸ", withdraw:"å‡ºé‡‘", limit:"1Må¿…è¦", addrPlace:"ã‚¢ãƒ‰ãƒ¬ã‚¹", sentMsg:"é€ä¿¡!" },
        ko: { start:"ì‹œìž‘", moveDesc:"ì´ë™", navGame:"ê²Œìž„", navNews:"ë‰´ìŠ¤", navChamp:"ëž­í‚¹", navWallet:"ì§€ê°‘", navSettings:"ì„¤ì •", refTitle:"ì¶”ì²œ", refDesc:"30% íšë“.", tgTitle:"ì»¤ë®¤ë‹ˆí‹°", tgDesc:"ì°¸ì—¬.", tgJoin:"ì°¸ì—¬", guideTitle:"ê°€ì´ë“œ", g1t:"ê²Œìž„", g1d:"ìˆ˜ì§‘.", g2t:"ì ", g2d:"ê³°ì„ í”¼í•˜ì„¸ìš”!", g3t:"ì¶œê¸ˆ", g3d:"í•œë„ 1.0M.", g4t:"ì¶”ì²œ", g4d:"30% ìˆ˜ìµ.", refMembers:"ë©¤ë²„", refEarnings:"ìˆ˜ìµ", gameOver:"ì˜¤ë¥˜", recover:"ë³µêµ¬", goToWallet:"ì§€ê°‘", langTitle:"ì–¸ì–´", lbDaily:"ë§¤ì¼", lbRef:"ë§¤ì›”", you:"ë‚˜", withdraw:"ì¶œê¸ˆ", limit:"1M í•„ìš”", addrPlace:"ì£¼ì†Œ", sentMsg:"ì „ì†¡!" },
        hi: { start:"à¤¶à¥à¤°à¥‚", moveDesc:"à¤¹à¤¿à¤²à¥‡à¤‚", navGame:"à¤–à¥‡à¤²", navNews:"à¤¸à¤®à¤¾à¤šà¤¾à¤°", navChamp:"à¤°à¥ˆà¤‚à¤•", navWallet:"à¤µà¥‰à¤²à¥‡à¤Ÿ", navSettings:"à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—à¥à¤¸", refTitle:"à¤°à¥‡à¤«à¤°à¤²", refDesc:"30% à¤•à¤®à¤¾à¤à¤‚à¥¤", tgTitle:"à¤¸à¤®à¥à¤¦à¤¾à¤¯", tgDesc:"à¤œà¥à¤¡à¤¼à¥‡à¤‚à¥¤", tgJoin:"à¤œà¥à¤¡à¤¼à¥‡à¤‚", guideTitle:"à¤—à¤¾à¤‡à¤¡", g1t:"à¤–à¥‡à¤²", g1d:"à¤œà¤®à¤¾ à¤•à¤°à¥‡à¤‚à¥¤", g2t:"à¤¦à¥à¤¶à¥à¤®à¤¨", g2d:"à¤­à¤¾à¤²à¥‚ à¤¸à¥‡ à¤¬à¤šà¥‡à¤‚!", g3t:"à¤¨à¤¿à¤•à¤¾à¤¸à¥€", g3d:"à¤¸à¥€à¤®à¤¾ 1.0Mà¥¤", g4t:"à¤°à¥‡à¤«à¤°à¤²", g4d:"30% à¤•à¤®à¤¾à¤à¤‚à¥¤", refMembers:"à¤¸à¤¦à¤¸à¥à¤¯", refEarnings:"à¤•à¤®à¤¾à¤ˆ", gameOver:"à¤•à¥à¤°à¥ˆà¤¶", recover:"à¤ªà¥à¤¨à¤°à¥à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤", goToWallet:"à¤µà¥‰à¤²à¥‡à¤Ÿ", langTitle:"à¤­à¤¾à¤·à¤¾", lbDaily:"à¤¦à¥ˆà¤¨à¤¿à¤•", lbRef:"à¤®à¤¾à¤¸à¤¿à¤•", you:"à¤†à¤ª", withdraw:"à¤¨à¤¿à¤•à¤¾à¤¸à¥€", limit:"1M à¤†à¤µà¤¶à¥à¤¯à¤•", addrPlace:"à¤ªà¤¤à¤¾", sentMsg:"à¤­à¥‡à¤œà¤¾!" }
    };
    const LANGUAGES=[{code:'tr',name:'TÃ¼rkÃ§e',flag:'ðŸ‡¹ðŸ‡·'},{code:'en',name:'English',flag:'ðŸ‡ºðŸ‡¸'},{code:'de',name:'Deutsch',flag:'ðŸ‡©ðŸ‡ª'},{code:'es',name:'EspaÃ±ol',flag:'ðŸ‡ªðŸ‡¸'},{code:'fr',name:'FranÃ§ais',flag:'ðŸ‡«ðŸ‡·'},{code:'ru',name:'Ð ÑƒÑÑÐºÐ¸Ð¹',flag:'ðŸ‡·ðŸ‡º'},{code:'pt',name:'PortuguÃªs',flag:'ðŸ‡µðŸ‡¹'},{code:'id',name:'Indonesia',flag:'ðŸ‡®ðŸ‡©'},{code:'ja',name:'æ—¥æœ¬èªž',flag:'ðŸ‡¯ðŸ‡µ'},{code:'ko',name:'í•œêµ­ì–´',flag:'ðŸ‡°ðŸ‡·'},{code:'hi',name:'à¤¹à¤¿à¤¨à¥à¤¦à¥€',flag:'ðŸ‡®ðŸ‡³'}];

    function t(key){ return (i18n[user.lang]||i18n.en)[key]||key; }
    function updateAllUI(){
        document.querySelectorAll('[data-lang]').forEach(el=>el.innerText=t(el.getAttribute('data-lang')));
        document.getElementById('activeLangName').innerText=LANGUAGES.find(x=>x.code===user.lang).name;
        updateHUD(); updateRefUI(); renderWallet();
    }

    function updateHUD(anim=false){ 
        const h=document.getElementById('hud-top'); h.innerHTML=''; 
        COINS.forEach(c=>{ h.innerHTML+=`<div class="hud-pill" style="border-color:${c.color}; ${anim?'transform:scale(1.1); transition:0.1s':''}"><div style="width:8px;height:8px;background:${c.color};border-radius:50%;"></div> ${c.id}: ${user.balances[c.id].toLocaleString()}</div>`; }); 
    }
    
    // --- CÃœZDAN & LÄ°G ---
    function renderWallet(){
        const l=document.getElementById('walletList'); l.innerHTML='';
        COINS.forEach(c=>{
            const current = user.balances[c.id]; const limit = 1000000;
            let percent = (current / limit) * 100; if(percent > 100) percent = 100;
            l.innerHTML+=`
            <div class="neon-card" style="border-color:${c.color}">
                <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                    <h3 style="color:${c.color}; margin:0;">${c.id}</h3>
                    <span style="font-size:18px; font-weight:bold;">${current.toLocaleString()}</span>
                </div>
                <div style="display:flex; justify-content:space-between; font-size:10px; color:#888; margin-bottom:3px;">
                    <span>${percent.toFixed(1)}%</span> <span>1.0M</span>
                </div>
                <div style="height:8px; background:#222; border-radius:4px; overflow:hidden; margin-bottom:15px; border:1px solid #444;">
                    <div style="height:100%; width:${percent}%; background:${c.color}; box-shadow:0 0 10px ${c.color}; transition: width 0.5s ease;"></div>
                </div>
                <input class="neon-input" placeholder="${t('addrPlace')}" value="${user.addresses[c.id]}" onchange="user.addresses['${c.id}']=this.value;saveData()" style="padding:10px; font-size:14px;">
                <button class="neon-btn" onclick="withdraw('${c.id}')" style="margin-top:10px; opacity:${percent>=100?1:0.5}; cursor:${percent>=100?'pointer':'not-allowed'}">
                    ${percent>=100 ? t('withdraw') : t('limit')}
                </button>
            </div>`;
        });
    }
    
    function updateRefUI(){ document.getElementById('totalRefs').innerText=user.referrals.length; document.getElementById('totalComm').innerText=user.totalComm.toLocaleString(); }

    window.simRef=function(){ alert("Bu buton demo iÃ§indir. GerÃ§ek davet iÃ§in linki paylaÅŸÄ±n."); }
    window.withdraw=function(id){ if(user.balances[id]<1000000){return;} user.balances[id]-=1000000; saveData(); renderWallet(); alert(t('sentMsg')); }
    window.openLangModal=()=>{ document.getElementById('modalOverlay').style.display='flex'; const l=document.getElementById('langList'); l.innerHTML=''; LANGUAGES.forEach(x=>{ l.innerHTML+=`<div class="lang-item" onclick="changeLang('${x.code}')">${x.flag} ${x.name}</div>`; }); }
    window.changeLang=(c)=>{ user.lang=c; saveData(); updateAllUI(); document.getElementById('modalOverlay').style.display='none'; }
    window.switchTab=function(tab){ document.querySelectorAll('.view-section').forEach(s=>s.classList.remove('active')); document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('active')); document.getElementById(tab+'View').classList.add('active'); document.getElementById('nav-'+tab).classList.add('active'); if(tab==='wallet') renderWallet(); if(tab==='champ') initLeaderboard(); }

    window.initLeaderboard = function() {
        const now = Date.now();
        if (!user.lbData || user.lbData.daily.length === 0 || (now - user.lbData.lastUpdate > 86400000)) {
            user.lbData = { daily: [], ref: [], lastUpdate: now };
            for(let i=0; i<30; i++) {
                user.lbData.daily.push({ name: `Miner_${Math.floor(1000+Math.random()*9000)}`, score: Math.floor(Math.random()*5000000)+500000 });
                user.lbData.ref.push({ name: `Ref_${Math.floor(10+Math.random()*90)}`, score: Math.floor(Math.random()*500)+10 });
            }
            saveData();
        }
        renderLeaderboard('daily');
    }
    window.switchLbTab = function(type) { document.getElementById('tabDaily').style.background = type==='daily'?'var(--neon-cyan)':'transparent'; document.getElementById('tabRef').style.background = type==='ref'?'var(--neon-cyan)':'transparent'; renderLeaderboard(type); }
    function renderLeaderboard(type) {
        const list = document.getElementById('rankContainer'); list.innerHTML='';
        let data = [...user.lbData[type]];
        let myScore = type==='daily' ? user.balances.USDT : user.referrals.length;
        data.push({ name:t('you'), score:myScore, isMe:true });
        data.sort((a,b)=>b.score-a.score);
        data.slice(0,30).forEach((item,i)=>{
            const rank = i+1; let style = item.isMe ? "border:1px solid var(--neon-cyan); background:rgba(0,243,255,0.1);" : "";
            list.innerHTML+=`<div class="rank-item" style="${style}"><div style="width:30px; text-align:center; font-weight:bold; color:${rank<=3?'var(--neon-gold)':'#666'}">${rank}</div><div style="flex:1; padding-left:10px;"><span style="font-weight:bold;">${item.name}</span></div><div style="font-weight:bold; font-family:monospace; color:var(--neon-cyan);">${item.score.toLocaleString()}</div></div>`;
        });
    }

    setInterval(()=>{ if(user.referrals.length>0 && Math.random()<0.2){ user.balances.USDT+=10000; user.totalComm+=10000; saveData(); updateHUD(); updateRefUI(); } }, 10000);

</script>
</body>
</html>
